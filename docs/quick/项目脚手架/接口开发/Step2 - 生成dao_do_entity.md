---
slug: '/quick/scaffold-api-gen-dao'
title: 'Step2 - 生成/dao/do/entity'
hide_title: true
sidebar_position: 2
---



## 检查工具配置
在使用脚手架工具之前，请检查本地的`cli`工具配置是否正确。默认的配置如下：
```yaml title="hack/config.yaml"
# CLI tool, only in development environment.
# https://goframe.org/docs/cli
gfcli:
  gen:
    dao:
    - link: "mysql:root:12345678@tcp(127.0.0.1:3306)/test"

  docker:
    build: "-a amd64 -s linux -p temp -ew"
    tagPrefixes:
    - my.image.pub/my-app
```
- 其中的`dao`部分配置即本次将要执行的命令的配置，其中的`link`为需要连接的数据库配置。
关于数据库的配置详细请参考章节 [ORM使用配置-配置文件](../../../docs/核心组件/数据库ORM/ORM使用配置/ORM使用配置-配置文件.md)。我们需要将此`link`配置改为我们的数据库连接地址。
- 其中`docker`配置项是模板默认提供的配置，用于镜像编译。这里不做详解，感兴趣可以参考开发手册中开发工具相关章节。

## 执行代码生成
将数据表创建好后，我们在项目根目录下执行`make dao`自动生成对应的`dao/do/entity`文件。

```text
$ make dao
generated: /Users/john/Temp/demo/internal/dao/user.go
generated: /Users/john/Temp/demo/internal/dao/internal/user.go
generated: /Users/john/Temp/demo/internal/model/do/user.go
generated: /Users/john/Temp/demo/internal/model/entity/user.go
done!
```

:::tip
`make`命令是在`*nix`系统下默认提供的指令，包括`Linux/MacOS`系统。如果是其他系统，例如`Windows`，默认不支持`make`命令，可以使用`gf gen dao`命令来替换。
:::

![goframe dao、do、entity](QQ_1731675850748.png)

每张表将会生成`4`个`Go`文件：
- `dao`：通过对象方式访问底层数据源，底层基于`ORM`组件实现。
- `do`：数据转换模型，用于业务模型到数据模型的转换，由工具维护，用户不能修改。工具每次生成代码文件将会覆盖该目录。
- `entity`：数据模型，由工具维护，用户不能修改。工具每次生成代码文件将会覆盖该目录。

更详细的介绍请参考章节 [数据规范-gen dao](../../../docs/开发工具/代码生成-gen/数据规范-gen%20dao.md)

### dao
生成的`dao`文件有两个：
- `internal/dao/internal/user.go`用于封装对数据表`user`的访问。该文件自动生成了一些数据结构和方法，简化对数据表的`CURD`操作。该文件每次生成都会覆盖，由开发工具自动维护。
- `internal/dao/user.go`其实对`internal/dao/internal/user.go`的进一步封装，用于供其他模块直接调用访问。该文件开发者可以随意修改，或者扩展`dao`的能力。

由于生成的`internal/dao/internal/user.go`文件完全由开发工具维护，那么我们只需看`internal/dao/user.go`这个生成的源码文件，后续如果有需要可以在这个文件上做功能扩展。

```go title="internal/dao/user.go"
// =================================================================================
// This is auto-generated by GoFrame CLI tool only once. Fill this file as you wish.
// =================================================================================

package dao

import (
    "demo/internal/dao/internal"
)

// internalUserDao is internal type for wrapping internal DAO implements.
type internalUserDao = *internal.UserDao

// userDao is the data access object for table user.
// You can define custom methods on it to extend its functionality as you wish.
type userDao struct {
    internalUserDao
}

var (
    // User is globally public accessible object for table user operations.
    User = userDao{
        internal.NewUserDao(),
    }
)

// Fill with you ideas below.

```



### do
```go title="internal/model/do/user.go"
// =================================================================================
// Code generated and maintained by GoFrame CLI tool. DO NOT EDIT.
// =================================================================================

package do

import (
    "github.com/gogf/gf/v2/frame/g"
)

// User is the golang structure of table user for DAO operations like Where/Data.
type User struct {
    g.Meta `orm:"table:user, do:true"`
    Id     interface{} // user id
    Name   interface{} // user name
    Status interface{} // user status
    Age    interface{} // user age
}
```
关于`do`数据转换模型的使用，我们将在后续代码逻辑中做展示。

### entity
```go title="internal/model/entity/user.go"
// =================================================================================
// Code generated and maintained by GoFrame CLI tool. DO NOT EDIT.
// =================================================================================

package entity

// User is the golang structure for table user.
type User struct {
    Id     uint   `json:"id"     orm:"id"     ` // user id
    Name   string `json:"name"   orm:"name"   ` // user name
    Status int    `json:"status" orm:"status" ` // user status
    Age    uint   `json:"age"    orm:"age"    ` // user age
}
```

可以看到该`entity`数据结构定义与数据表字段一一对应。